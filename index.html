<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…»è€é‡‘è®¡ç®—å™¨ - ä¸“ä¸šé€€ä¼‘è§„åˆ’å·¥å…·</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #27ae60;
            --warning: #f39c12;
            --info: #2980b9;
            --card-shadow: 0 10px 30px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Noto Sans SC', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e7f1 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--secondary), var(--success));
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 2.8rem;
            font-weight: 700;
        }
        
        .subtitle {
            color: #7f8c8d;
            font-size: 1.25rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
        }
        
        .stats-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 25px;
        }
        
        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px 25px;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border-left: 4px solid var(--info);
        }
        
        .stat-card h3 {
            color: var(--info);
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        
        .stat-card p {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .calculator-container {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            margin-bottom: 40px;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--card-shadow);
        }
        
        .result-section {
            flex: 1;
            min-width: 300px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            display: flex;
            flex-direction: column;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        h2 {
            color: var(--secondary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light);
            font-size: 1.8rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        h2 i {
            background: rgba(52, 152, 219, 0.1);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .form-group {
            margin-bottom: 30px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.05rem;
        }
        
        .info-icon {
            color: var(--secondary);
            cursor: pointer;
            position: relative;
            display: inline-flex;
        }
        
        .info-tooltip {
            position: absolute;
            background: rgba(0,0,0,0.85);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            width: 320px;
            z-index: 100;
            top: 30px;
            left: 0;
            display: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            line-height: 1.6;
        }
        
        .info-tooltip strong {
            color: #3498db;
            display: block;
            margin-bottom: 5px;
        }
        
        .info-icon:hover .info-tooltip {
            display: block;
        }
        
        input, select {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e0e6ed;
            border-radius: 8px;
            font-size: 1.05rem;
            transition: var(--transition);
            background: #f8fafc;
        }
        
        input:focus, select:focus {
            border-color: var(--secondary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .range-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: #e0e6ed;
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            background: var(--secondary);
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            background: #2980b9;
            transform: scale(1.2);
        }
        
        .range-value {
            min-width: 70px;
            text-align: center;
            font-weight: 700;
            color: var(--secondary);
            background: rgba(52, 152, 219, 0.1);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 1.05rem;
        }
        
        .btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 16px 25px;
            font-size: 1.15rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(52, 152, 219, 0.3);
        }
        
        .result-display {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        
        .result-value {
            font-size: 3.2rem;
            font-weight: 800;
            color: var(--success);
            text-align: center;
            margin: 25px 0;
            text-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }
        
        .result-details {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eef2f7;
            font-size: 1.05rem;
        }
        
        .detail-item:last-child {
            border-bottom: none;
        }
        
        .detail-value {
            font-weight: 700;
            color: var(--primary);
        }
        
        .progress-container {
            margin: 30px 0;
        }
        
        .progress-bar {
            height: 24px;
            background: #e0e0e0;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--success));
            width: 0;
            transition: width 1s ease-in-out;
            position: relative;
        }
        
        .progress-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 100%);
        }
        
        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.95rem;
            color: #7f8c8d;
        }
        
        .recommendation {
            background: #e3f2fd;
            border-left: 4px solid var(--secondary);
            padding: 20px;
            margin-top: 25px;
            border-radius: 0 8px 8px 0;
            font-size: 1rem;
            line-height: 1.7;
        }
        
        .recommendation strong {
            color: var(--info);
        }
        
        .tips-section {
            margin-top: 40px;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            margin-bottom: 40px;
        }
        
        .tips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .tip-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-top: 4px solid var(--secondary);
        }
        
        .tip-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        .tip-card h3 {
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
        }
        
        .tip-card i {
            background: rgba(52, 152, 219, 0.1);
            width: 42px;
            height: 42px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: var(--secondary);
        }
        
        .tip-card p {
            color: #555;
            line-height: 1.7;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #eee;
            font-size: 15px;
            color: var(--gray);
            text-align: center;
            background: white;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            padding: 30px;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .footer-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .footer-info div {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 15px;
            background: rgba(108, 117, 125, 0.08);
            border-radius: 20px;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .footer-info div:hover {
            background: rgba(108, 117, 125, 0.15);
            transform: translateY(-2px);
        }
        
        .footer a {
            color: var(--secondary);
            text-decoration: none;
            transition: var(--transition);
            font-weight: 600;
        }
        
        .footer a:hover {
            color: var(--primary);
            text-decoration: underline;
        }
        
        .data-sources {
            max-width: 800px;
            margin: 20px auto 0;
            text-align: left;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            border-left: 4px solid var(--secondary);
        }
        
        .data-sources h3 {
            color: var(--info);
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .data-sources ul {
            padding-left: 25px;
        }
        
        .data-sources li {
            margin-bottom: 8px;
            line-height: 1.7;
            position: relative;
        }
        
        .data-sources li::before {
            content: "ğŸ“Š";
            position: absolute;
            left: -20px;
            top: 0;
        }
        
        @media (max-width: 768px) {
            .footer-info {
                flex-direction: column;
                gap: 15px;
            }
            
            .footer-info div {
                width: 100%;
                max-width: 300px;
                justify-content: center;
            }
        }
        
        /* æ–°å¢æ ·å¼ */
        .city-selector {
            display: flex;
            gap: 15px;
        }
        .city-selector .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        .location-info {
            font-size: 0.9rem;
            padding: 8px 10px;
            border-radius: 6px;
            background: #f8f9fa;
            margin-top: 5px;
            display: flex;
            align-items: center;
        }
        .location-info i {
            color: var(--success);
            margin-right: 5px;
        }
        
        .input-error {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 5px;
            padding: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .global-error {
            background: #fdeded;
            border: 1px solid #fadbd8;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .input-error i, .global-error i {
            margin-right: 8px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .loading-spinner {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .loading-spinner i {
            font-size: 2rem;
            color: var(--secondary);
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .calculator-container {
                flex-direction: column;
            }
            
            .result-value {
                font-size: 2.8rem;
            }
            
            .stats-container {
                flex-direction: column;
                align-items: center;
            }
            
            .stat-card {
                width: 100%;
                max-width: 300px;
            }
            
            .city-selector {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-calculator"></i> å…»è€é‡‘è®¡ç®—å™¨-Power By Deepseek</h1>
            <p class="subtitle">ç»¼åˆè€ƒè™‘ä¸ªäººæ”¶å…¥ã€ç¼´è´¹å¹´é™ã€æŠ•èµ„å›æŠ¥ç‡ç­‰å…³é”®å› ç´ ï¼Œç²¾å‡†é¢„æµ‹æ‚¨çš„é€€ä¼‘å…»è€é‡‘æ”¶å…¥ï¼ŒåŠ©æ‚¨ç§‘å­¦è§„åˆ’å…»è€ç”Ÿæ´»</p>
            
            <div class="stats-container">
                <div class="stat-card">
                    <h3>2025å¹´å…¨å›½å¹³å‡å…»è€é‡‘</h3>
                    <p>Â¥4,210/æœˆ</p>
                </div>
                <div class="stat-card">
                    <h3>å…»è€é‡‘ç›®æ ‡æ›¿ä»£ç‡</h3>
                    <p>70%ä»¥ä¸Š</p>
                </div>
                <div class="stat-card">
                    <h3>2025å¹´ä¸ªäººè´¦æˆ·è®°è´¦åˆ©ç‡</h3>
                    <p>5.5%-7.5%</p>
                </div>
                <div class="stat-card">
                    <h3>2025å¹´ä¸Šæµ·å¸‚å¹³å‡å·¥èµ„</h3>
                    <p>Â¥17,922/æœˆ</p>
                </div>
            </div>
        </header>
        
        <div class="calculator-container">
            <div class="input-section">
                <h2><i class="fas fa-edit"></i> ä¸ªäººä¿¡æ¯è®¾ç½®</h2>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-user"></i> å½“å‰å¹´é¾„
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                æ ¹æ®å›½å®¶å«å¥å§”ã€Š2023å¹´æˆ‘å›½å«ç”Ÿå¥åº·äº‹ä¸šå‘å±•ç»Ÿè®¡å…¬æŠ¥ã€‹ï¼Œæˆ‘å›½å±…æ°‘äººå‡é¢„æœŸå¯¿å‘½ä¸º79.2å²ï¼Œä¸”å‘ˆæŒç»­å¢é•¿è¶‹åŠ¿ã€‚åŸé•‡èŒå·¥å¹³å‡é€€ä¼‘å¹´é¾„ä¸ºç”·æ€§60å²ï¼Œå¥³æ€§55å²ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="age" min="20" max="65" value="30">
                        <span class="range-value" id="age-value">30å²</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-calendar-alt"></i> è®¡åˆ’é€€ä¼‘å¹´é¾„
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                æ ¹æ®ç°è¡Œæ”¿ç­–ï¼šç”·æ€§60å²é€€ä¼‘ï¼Œå¥³å¹²éƒ¨55å²é€€ä¼‘ï¼Œå¥³èŒå·¥50å²é€€ä¼‘ã€‚å›½å®¶æ­£åœ¨ç ”ç©¶æ¸è¿›å¼å»¶è¿Ÿé€€ä¼‘æ–¹æ¡ˆï¼Œé¢„è®¡åˆ°2045å¹´ç”·å¥³é€€ä¼‘å¹´é¾„ç»Ÿä¸€ä¸º65å²ã€‚æ‚¨å¯ä»¥æ ¹æ®ä¸ªäººæƒ…å†µè‡ªå®šä¹‰é€€ä¼‘å¹´é¾„ï¼ˆ50-70å²ï¼‰ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="number" id="retirement-age" min="50" max="70" value="60" style="flex: 1;">
                        <span class="range-value" id="retirement-age-value">60å²</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-money-bill-wave"></i> å½“å‰æœˆæ”¶å…¥ (å…ƒ)
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                å›½å®¶ç»Ÿè®¡å±€æ•°æ®æ˜¾ç¤ºï¼Œ2024å¹´å…¨å›½è§„æ¨¡ä»¥ä¸Šä¼ä¸šå°±ä¸šäººå‘˜æœˆå¹³å‡å·¥èµ„ä¸º9580å…ƒã€‚ä¸€çº¿åŸå¸‚å¹³å‡å·¥èµ„çº¦ä¸ºå…¨å›½å¹³å‡æ°´å¹³çš„1.5-2å€ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="income" min="3000" max="50000" value="6000" step="500">
                        <span class="range-value" id="income-value">6,000å…ƒ</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-percent"></i> ç¼´è´¹åŸºæ•°æ¯”ä¾‹
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                æ ¹æ®ã€Šç¤¾ä¼šä¿é™©æ³•ã€‹ï¼Œç¼´è´¹åŸºæ•°åº”åœ¨å½“åœ°ç¤¾å¹³å·¥èµ„60%-300%ä¹‹é—´ã€‚ä¸ªäººç¼´è´¹æ¯”ä¾‹ä¸º8%ï¼Œå•ä½ç¼´è´¹æ¯”ä¾‹ä¸º16%ã€‚é€‰æ‹©è¾ƒé«˜ç¼´è´¹åŸºæ•°å¯æå‡å…»è€é‡‘æ°´å¹³ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="contribution-rate" min="60" max="300" value="100">
                        <span class="range-value" id="contribution-rate-value">100%</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-history"></i> å·²ç¼´è´¹å¹´é™
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                é¢†å–å…»è€é‡‘éœ€æ»¡è¶³æœ€ä½ç¼´è´¹15å¹´ã€‚æ ¹æ®äººç¤¾éƒ¨æ•°æ®ï¼Œ2024å¹´å…¨å›½å¹³å‡ç¼´è´¹å¹´é™ä¸º27å¹´ã€‚ç¼´è´¹å¹´é™æ¯å¢åŠ 1å¹´ï¼ŒåŸºç¡€å…»è€é‡‘å¢åŠ çº¦1%ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="years-paid" min="0" max="40" value="10">
                        <span class="range-value" id="years-paid-value">10å¹´</span>
                    </div>
                </div>
                
                <!-- æ–°å¢ï¼šå½“å‰ä¸ªäººè´¦æˆ·ä½™é¢ -->
                <div class="form-group">
                    <label>
                        <i class="fas fa-piggy-bank"></i> å½“å‰ä¸ªäººè´¦æˆ·ä½™é¢ (å…ƒ)
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                æˆªè‡³2025å¹´ï¼Œå…¨å›½ä¸ªäººå…»è€é‡‘è´¦æˆ·å¹³å‡ä½™é¢çº¦ä¸º12ä¸‡å…ƒï¼Œä¸€çº¿åŸå¸‚æ™®éé«˜äº20ä¸‡å…ƒã€‚è´¦æˆ·ä½™é¢å°†å½±å“ä¸ªäººè´¦æˆ·å…»è€é‡‘æ°´å¹³ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="current-balance" min="0" max="800000" value="30000" step="1000">
                        <span class="range-value" id="current-balance-value">30,000å…ƒ</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-chart-line"></i> å·¥èµ„å¹´å¢é•¿ç‡
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                è¿‡å»åå¹´æˆ‘å›½å¹³å‡å·¥èµ„å¹´å¢é•¿ç‡çº¦8%ã€‚è€ƒè™‘åˆ°ç»æµå‘å±•æ–°å¸¸æ€ï¼Œæœªæ¥åå¹´å·¥èµ„å¢é•¿ç‡é¢„è®¡åœ¨4%å·¦å³ã€‚å›½å®¶è§„åˆ’ç›®æ ‡ä¸ºå±…æ°‘æ”¶å…¥å¢é•¿ä¸GDPå¢é•¿åŸºæœ¬åŒæ­¥ã€‚æ‚¨å¯ä¾æ®å½“å‰ç»æµç¯å¢ƒåˆç†è®¾ç½®å·¥èµ„å¢é•¿ç‡ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="salary-growth" min="0" max="10" value="0" step="0.5">
                        <span class="range-value" id="salary-growth-value">0%</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>
                        <i class="fas fa-coins"></i> ä¸ªäººè´¦æˆ·æ”¶ç›Šç‡
                        <span class="info-icon">
                            <i class="fas fa-info-circle"></i>
                            <span class="info-tooltip">
                                <strong>å‚è€ƒä¾æ®</strong>
                                äººç¤¾éƒ¨å…¬å¸ƒ2024å¹´èŒå·¥å…»è€ä¿é™©ä¸ªäººè´¦æˆ·è®°è´¦åˆ©ç‡ä¸º6.25%ã€‚å†å²å¹³å‡è®°è´¦åˆ©ç‡çº¦ä¸º5%-8%ã€‚è¯¥åˆ©ç‡ç”±å›½åŠ¡é™¢ç»Ÿä¸€ç¡®å®šï¼Œå‚è€ƒé“¶è¡Œå­˜æ¬¾åˆ©ç‡å’Œç‰©ä»·æŒ‡æ•°ç­‰å› ç´ ã€‚æ‚¨å¯ä¾æ®å½“å‰ç»æµç¯å¢ƒåˆç†è®¾ç½®ä¸ªäººè´¦æˆ·æ”¶ç›Šç‡ã€‚
                            </span>
                        </span>
                    </label>
                    <div class="range-container">
                        <input type="range" id="return-rate" min="2" max="12" value="5" step="0.5">
                        <span class="range-value" id="return-rate-value">5%</span>
                    </div>
                </div>
                
                <!-- é‡æ„ï¼šé¢„æœŸé€€ä¼‘åœ°é€‰æ‹© -->
                <div class="city-selector">
                    <div class="form-group">
                        <label><i class="fas fa-map-marked-alt"></i> é¢„æœŸé€€ä¼‘çœä»½</label>
                        <select id="province">
                            <option value="">-- é€‰æ‹©çœä»½ --</option>
                            <!-- å„çœä»½ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-city"></i> é¢„æœŸé€€ä¼‘åŸå¸‚</label>
                        <select id="city">
                            <option value="">-- é€‰æ‹©åŸå¸‚ --</option>
                            <!-- å„åŸå¸‚ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                        </select>
                    </div>
                </div>
                
                <div class="location-info">
                    <i class="fas fa-info-circle"></i>
                    <span id="location-info-text">è¯·é€‰æ‹©çœä»½å’ŒåŸå¸‚è·å–å½“åœ°æœ€æ–°å¹³å‡å·¥èµ„æ•°æ®</span>
                </div>
                
                <button id="calculate-btn" class="btn">
                    <i class="fas fa-calculator"></i> è®¡ç®—å…»è€é‡‘
                </button>
                
                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button id="save-settings-btn" class="btn" style="background: #9b59b6; padding: 12px;">
                        <i class="fas fa-save"></i> ä¿å­˜è®¾ç½®
                    </button>
                    <button id="view-history-btn" class="btn" style="background: #34495e; padding: 12px;">
                        <i class="fas fa-history"></i> æŸ¥çœ‹å†å²
                    </button>
                </div>
                
                <!-- å†å²è®°å½•æ¨¡æ€æ¡† -->
                <div id="history-modal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center;">
                    <div class="modal-content" style="background: white; padding: 25px; border-radius: 10px; width: 80%; max-width: 800px; max-height: 80vh; overflow-y: auto; position: relative;">
                        <h3 style="margin-top: 0; color: var(--primary); border-bottom: 2px solid var(--light); padding-bottom: 15px;"><i class="fas fa-history"></i> è®¡ç®—å†å²è®°å½•</h3>
                        <div id="history-list" style="margin: 15px 0;"></div>
                        <button id="close-history-btn" class="btn" style="background: #95a5a6; margin-top: 15px;">å…³é—­</button>
                        <button id="clear-history-btn" class="btn" style="background: #e74c3c; margin-top: 15px; margin-left: 10px;">æ¸…ç©ºå†å²</button>
                    </div>
                </div>
            </div>
            
            <div class="result-section">
                <h2><i class="fas fa-chart-line"></i> è®¡ç®—ç»“æœåˆ†æ</h2>
                
                <div class="result-display">
                    <div class="result-value">Â¥8,650/æœˆ</div>
                    <p style="text-align: center; color: #7f8c8d; font-size: 1.1rem;">é¢„ä¼°é€€ä¼‘åæ¯æœˆå¯é¢†å–å…»è€é‡‘</p>
                    
                    <div class="progress-container">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 58%;"></div>
                        </div>
                        <div class="progress-labels">
                            <span>0%</span>
                            <span>å…»è€é‡‘æ›¿ä»£ç‡</span>
                            <span>100%</span>
                        </div>
                    </div>
                    
                    <div class="result-details">
                        <div class="detail-item">
                            <span>åŸºç¡€å…»è€é‡‘ï¼š</span>
                            <span class="detail-value">Â¥5,420/æœˆ</span>
                        </div>
                        <div class="detail-item">
                            <span>ä¸ªäººè´¦æˆ·å…»è€é‡‘ï¼š</span>
                            <span class="detail-value">Â¥3,230/æœˆ</span>
                        </div>
                        <div class="detail-item">
                            <span>æ€»ç¼´è´¹å¹´é™ï¼š</span>
                            <span class="detail-value">35å¹´</span>
                        </div>
                        <div class="detail-item">
                            <span>å…»è€é‡‘æ›¿ä»£ç‡ï¼š</span>
                            <span class="detail-value">58%</span>
                        </div>
                        <div class="detail-item">
                            <span>å…¨å›½å¹³å‡å…»è€é‡‘ï¼š</span>
                            <span class="detail-value">Â¥4,210/æœˆ</span>
                        </div>
                        <div class="detail-item">
                            <span>ç›®æ ‡æ›¿ä»£ç‡ï¼š</span>
                            <span class="detail-value">70%ä»¥ä¸Š</span>
                        </div>
                        <div class="detail-item">
                            <span>é€€ä¼‘åœ°å¹³å‡å·¥èµ„ï¼š</span>
                            <span class="detail-value">Â¥12,500/æœˆ</span>
                        </div>
                    </div>
                    
                    <div class="recommendation">
                        <strong><i class="fas fa-lightbulb"></i> ä¼˜åŒ–å»ºè®®ï¼š</strong> 
                        æ‚¨çš„å…»è€é‡‘æ›¿ä»£ç‡ä½äºå›½é™…åŠ³å·¥ç»„ç»‡å»ºè®®çš„70%æ ‡å‡†ã€‚å»ºè®®ï¼š1) å»¶é•¿å·¥ä½œå¹´é™è‡³65å²ï¼›2) æé«˜ç¼´è´¹åŸºæ•°è‡³120%ï¼›3) å‚åŠ ä¸ªäººå…»è€é‡‘è®¡åˆ’ï¼Œæ¯å¹´å¯äº«å—æœ€é«˜Â¥5,400ç¨æ”¶ä¼˜æƒ ã€‚
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tips-section">
            <h2><i class="fas fa-lightbulb"></i> å…»è€é‡‘ä¼˜åŒ–ç­–ç•¥</h2>
            
            <div class="tips-grid">
                <div class="tip-card">
                    <h3><i class="fas fa-coins"></i> æé«˜ç¼´è´¹åŸºæ•°</h3>
                    <p>åœ¨æ”¿ç­–å…è®¸èŒƒå›´å†…ï¼ˆ60%-300%ç¤¾å¹³å·¥èµ„ï¼‰æé«˜å…»è€ä¿é™©ç¼´è´¹åŸºæ•°ã€‚ç¼´è´¹åŸºæ•°æ¯æé«˜10%ï¼Œä¸ªäººè´¦æˆ·å…»è€é‡‘å¯å¢åŠ çº¦8%ã€‚</p>
                </div>
                
                <div class="tip-card">
                    <h3><i class="fas fa-user-clock"></i> å»¶é•¿å·¥ä½œå¹´é™</h3>
                    <p>æ¯å¤šå·¥ä½œä¸€å¹´ï¼Œç¼´è´¹å¹´é™å¢åŠ ï¼Œå…»è€é‡‘ä¹Ÿä¼šç›¸åº”æé«˜5-8%ã€‚65å²é€€ä¼‘æ¯”60å²é€€ä¼‘å…»è€é‡‘å¯å¢åŠ 30%ä»¥ä¸Šã€‚</p>
                </div>
                
                <div class="tip-card">
                    <h3><i class="fas fa-piggy-bank"></i> ä¸ªäººå…»è€é‡‘è´¦æˆ·</h3>
                    <p>å‚åŠ ä¸ªäººå…»è€é‡‘åˆ¶åº¦ï¼Œæ¯å¹´æœ€é«˜ç¼´å­˜Â¥12,000ï¼Œäº«å—ç¨æ”¶ä¼˜æƒ ã€‚æŒ‰6%æ”¶ç›Šç‡è®¡ç®—ï¼Œ30å¹´ç§¯ç´¯å¯è¾¾Â¥100ä¸‡ä»¥ä¸Šã€‚</p>
                </div>
                
                <div class="tip-card">
                    <h3><i class="fas fa-chart-pie"></i> å¤šå…ƒåŒ–æŠ•èµ„</h3>
                    <p>å…»è€å‚¨è“„åº”åˆç†é…ç½®ï¼š50%ç¨³å¥äº§å“ï¼ˆå­˜æ¬¾ã€å›½å€ºï¼‰ï¼Œ30%å¹³è¡¡å‹äº§å“ï¼ˆç†è´¢ã€å€ºåˆ¸åŸºé‡‘ï¼‰ï¼Œ20%æˆé•¿å‹äº§å“ï¼ˆæŒ‡æ•°åŸºé‡‘ï¼‰ã€‚</p>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <div class="footer-content">
                <div class="footer-info">
                    <div><i class="fas fa-user"></i> ä½œè€…ï¼šä½•è‰³æ—</div>
                    <div><i class="fas fa-code-branch"></i> ç‰ˆæœ¬ï¼šV1.2.0</div>
                    <div><i class="fas fa-calendar"></i> æ›´æ–°æ—¥æœŸï¼š2026å¹´1æœˆ</div>
                </div>
                
                <div class="footer-info">
                    <div><i class="fab fa-github"></i> GitHubï¼š<a href="https://github.com/caifugao110/Pension_Calculator" target="_blank">https://github.com/caifugao110/Pension_Calculator</a></div>
                </div>
                
                <div class="footer-info">
                    <div><i class="fas fa-info-circle"></i> å…è´£å£°æ˜ï¼šè®¡ç®—ç»“æœä»…ä¾›å‚è€ƒï¼Œå®é™…å…»è€é‡‘ä»¥é€€ä¼‘æ—¶å½“åœ°ç¤¾ä¿éƒ¨é—¨æ ¸ç®—ä¸ºå‡†</div>
                </div>
                
                <div class="data-sources">
                    <h3><i class="fas fa-book"></i> æ•°æ®æ¥æºä¸å‚è€ƒä¾æ®</h3>
                    <ul>
                        <li>å›½å®¶ç»Ÿè®¡å±€ã€Š2024å¹´å›½æ°‘ç»æµå’Œç¤¾ä¼šå‘å±•ç»Ÿè®¡å…¬æŠ¥ã€‹</li>
                        <li>äººåŠ›èµ„æºå’Œç¤¾ä¼šä¿éšœéƒ¨ã€Š2024å¹´åº¦äººåŠ›èµ„æºå’Œç¤¾ä¼šä¿éšœäº‹ä¸šå‘å±•ç»Ÿè®¡å…¬æŠ¥ã€‹</li>
                        <li>å›½åŠ¡é™¢ã€Š"åå››äº”"å›½å®¶è€é¾„äº‹ä¸šå‘å±•å’Œå…»è€æœåŠ¡ä½“ç³»è§„åˆ’ã€‹</li>
                        <li>å„çœå¸‚äººåŠ›èµ„æºå’Œç¤¾ä¼šä¿éšœå±€2025å¹´ç¤¾ä¿ç¼´è´¹åŸºæ•°é€šçŸ¥</li>
                        <li>ä¸–ç•Œé“¶è¡Œã€Šä¸­å›½å…»è€é‡‘èæ”¹é©æŠ¥å‘Šã€‹</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿä»APIè·å–æ•°æ®çš„å‡½æ•°
        async function fetchSalaryData() {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šè°ƒç”¨çœŸå®çš„API
            // ä¸ºäº†æ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬è¿”å›ä¸€ä¸ªæ¨¡æ‹Ÿçš„Promise
            return new Promise((resolve) => {
                setTimeout(() => {
                    resolve({
                        "åŒ—äº¬": {
                            "åŒ—äº¬": 18717
                        },
                        "å¤©æ´¥": {
                            "å¤©æ´¥": 11870
                        },
                        "æ²³åŒ—": {
                            "çŸ³å®¶åº„": 8087,
                            "å”å±±": 8087,
                            "ç§¦çš‡å²›": 8087,
                            "é‚¯éƒ¸": 8087,
                            "é‚¢å°": 8087,
                            "ä¿å®š": 8087,
                            "å¼ å®¶å£": 8087,
                            "æ‰¿å¾·": 8087,
                            "æ²§å·": 8087,
                            "å»ŠåŠ": 8087,
                            "è¡¡æ°´": 8087
                        },
                        "å±±è¥¿": {
                            "å¤ªåŸ": 8148,
                            "å¤§åŒ": 8148,
                            "é˜³æ³‰": 8148,
                            "é•¿æ²»": 8148,
                            "æ™‹åŸ": 8148,
                            "æœ”å·": 8148,
                            "æ™‹ä¸­": 8148,
                            "è¿åŸ": 8148,
                            "å¿»å·": 8148,
                            "ä¸´æ±¾": 8148,
                            "å•æ¢": 8148
                        },
                        "å†…è’™å¤": {
                            "å‘¼å’Œæµ©ç‰¹": 10342,
                            "åŒ…å¤´": 10342,
                            "ä¹Œæµ·": 10342,
                            "èµ¤å³°": 10342,
                            "é€šè¾½": 10342,
                            "é„‚å°”å¤šæ–¯": 10342,
                            "å‘¼ä¼¦è´å°”": 10342,
                            "å·´å½¦æ·–å°”": 10342,
                            "ä¹Œå…°å¯Ÿå¸ƒ": 10342,
                            "å…´å®‰ç›Ÿ": 10342,
                            "é”¡æ—éƒ­å‹’ç›Ÿ": 10342,
                            "é˜¿æ‹‰å–„ç›Ÿ": 10342
                        },
                        "è¾½å®": {
                            "æ²ˆé˜³": 10342,
                            "å¤§è¿": 10342,
                            "éå±±": 10342,
                            "æŠšé¡º": 10342,
                            "æœ¬æºª": 10342,
                            "ä¸¹ä¸œ": 10342,
                            "é”¦å·": 10342,
                            "è¥å£": 10342,
                            "é˜œæ–°": 10342,
                            "è¾½é˜³": 10342,
                            "ç›˜é”¦": 10342,
                            "é“å²­": 10342,
                            "æœé˜³": 10342,
                            "è‘«èŠ¦å²›": 10342
                        },
                        "å‰æ—": {
                            "é•¿æ˜¥": 10342,
                            "å‰æ—": 10342,
                            "å››å¹³": 10342,
                            "è¾½æº": 10342,
                            "é€šåŒ–": 10342,
                            "ç™½å±±": 10342,
                            "æ¾åŸ": 10342,
                            "ç™½åŸ": 10342,
                            "å»¶è¾¹æœé²œæ—è‡ªæ²»å·": 10342
                        },
                        "é»‘é¾™æ±Ÿ": {
                            "å“ˆå°”æ»¨": 10342,
                            "é½é½å“ˆå°”": 10342,
                            "é¸¡è¥¿": 10342,
                            "é¹¤å²—": 10342,
                            "åŒé¸­å±±": 10342,
                            "å¤§åº†": 10342,
                            "ä¼Šæ˜¥": 10342,
                            "ä½³æœ¨æ–¯": 10342,
                            "ä¸ƒå°æ²³": 10342,
                            "ç‰¡ä¸¹æ±Ÿ": 10342,
                            "é»‘æ²³": 10342,
                            "ç»¥åŒ–": 10342,
                            "å¤§å…´å®‰å²­åœ°åŒº": 10342
                        },
                        "ä¸Šæµ·": {
                            "ä¸Šæµ·": 17500
                        },
                        "æ±Ÿè‹": {
                            "å—äº¬": 10768,
                            "æ— é”¡": 10768,
                            "å¾å·": 10768,
                            "å¸¸å·": 10768,
                            "è‹å·": 10768,
                            "å—é€š": 10768,
                            "è¿äº‘æ¸¯": 10768,
                            "æ·®å®‰": 10768,
                            "ç›åŸ": 10768,
                            "æ‰¬å·": 10768,
                            "é•‡æ±Ÿ": 10768,
                            "æ³°å·": 10768,
                            "å®¿è¿": 10768
                        },
                        "æµ™æ±Ÿ": {
                            "æ­å·": 11437,
                            "å®æ³¢": 11437,
                            "æ¸©å·": 11437,
                            "å˜‰å…´": 11437,
                            "æ¹–å·": 11437,
                            "ç»å…´": 11437,
                            "é‡‘å": 11437,
                            "è¡¢å·": 11437,
                            "èˆŸå±±": 11437,
                            "å°å·": 11437,
                            "ä¸½æ°´": 11437
                        },
                        "å®‰å¾½": {
                            "åˆè‚¥": 8785,
                            "èŠœæ¹–": 8785,
                            "èšŒåŸ ": 8785,
                            "æ·®å—": 8785,
                            "é©¬éå±±": 8785,
                            "æ·®åŒ—": 8785,
                            "é“œé™µ": 8785,
                            "å®‰åº†": 8785,
                            "é»„å±±": 8785,
                            "æ»å·": 8785,
                            "é˜œé˜³": 8785,
                            "å®¿å·": 8785,
                            "å…­å®‰": 8785,
                            "äº³å·": 8785,
                            "æ± å·": 8785,
                            "å®£åŸ": 8785
                        },
                        "ç¦å»º": {
                            "ç¦å·": 9365,
                            "å¦é—¨": 9365,
                            "è†ç”°": 9365,
                            "ä¸‰æ˜": 9365,
                            "æ³‰å·": 9365,
                            "æ¼³å·": 9365,
                            "å—å¹³": 9365,
                            "é¾™å²©": 9365,
                            "å®å¾·": 9365
                        },
                        "æ±Ÿè¥¿": {
                            "å—æ˜Œ": 7979,
                            "æ™¯å¾·é•‡": 7979,
                            "èä¹¡": 7979,
                            "ä¹æ±Ÿ": 7979,
                            "æ–°ä½™": 7979,
                            "é¹°æ½­": 7979,
                            "èµ£å·": 7979,
                            "å‰å®‰": 7979,
                            "å®œæ˜¥": 7979,
                            "æŠšå·": 7979,
                            "ä¸Šé¥¶": 7979
                        },
                        "å±±ä¸œ": {
                            "æµå—": 10342,
                            "é’å²›": 10342,
                            "æ·„åš": 10342,
                            "æ£åº„": 10342,
                            "ä¸œè¥": 10342,
                            "çƒŸå°": 10342,
                            "æ½åŠ": 10342,
                            "æµå®": 10342,
                            "æ³°å®‰": 10342,
                            "å¨æµ·": 10342,
                            "æ—¥ç…§": 10342,
                            "ä¸´æ²‚": 10342,
                            "å¾·å·": 10342,
                            "èŠåŸ": 10342,
                            "æ»¨å·": 10342,
                            "èæ³½": 10342
                        },
                        "æ²³å—": {
                            "éƒ‘å·": 10342,
                            "å¼€å°": 10342,
                            "æ´›é˜³": 10342,
                            "å¹³é¡¶å±±": 10342,
                            "å®‰é˜³": 10342,
                            "é¹¤å£": 10342,
                            "æ–°ä¹¡": 10342,
                            "ç„¦ä½œ": 10342,
                            "æ¿®é˜³": 10342,
                            "è®¸æ˜Œ": 10342,
                            "æ¼¯æ²³": 10342,
                            "ä¸‰é—¨å³¡": 10342,
                            "å—é˜³": 10342,
                            "å•†ä¸˜": 10342,
                            "ä¿¡é˜³": 10342,
                            "å‘¨å£": 10342,
                            "é©»é©¬åº—": 10342,
                            "çœç›´è¾–å¿çº§è¡Œæ”¿åŒºåˆ’": 10342
                        },
                        "æ¹–åŒ—": {
                            "æ­¦æ±‰": 10342,
                            "é»„çŸ³": 10342,
                            "åå °": 10342,
                            "å®œæ˜Œ": 10342,
                            "è¥„é˜³": 10342,
                            "é„‚å·": 10342,
                            "è†é—¨": 10342,
                            "å­æ„Ÿ": 10342,
                            "è†å·": 10342,
                            "é»„å†ˆ": 10342,
                            "å’¸å®": 10342,
                            "éšå·": 10342,
                            "æ©æ–½åœŸå®¶æ—è‹—æ—è‡ªæ²»å·": 10342,
                            "çœç›´è¾–å¿çº§è¡Œæ”¿åŒºåˆ’": 10342
                        },
                        "æ¹–å—": {
                            "é•¿æ²™": 10342,
                            "æ ªæ´²": 10342,
                            "æ¹˜æ½­": 10342,
                            "è¡¡é˜³": 10342,
                            "é‚µé˜³": 10342,
                            "å²³é˜³": 10342,
                            "å¸¸å¾·": 10342,
                            "å¼ å®¶ç•Œ": 10342,
                            "ç›Šé˜³": 10342,
                            "éƒ´å·": 10342,
                            "æ°¸å·": 10342,
                            "æ€€åŒ–": 10342,
                            "å¨„åº•": 10342,
                            "æ¹˜è¥¿åœŸå®¶æ—è‹—æ—è‡ªæ²»å·": 10342
                        },
                        "å¹¿ä¸œ": {
                            "å¹¿å·": 11283,
                            "éŸ¶å…³": 11283,
                            "æ·±åœ³": 11283,
                            "ç æµ·": 11283,
                            "æ±•å¤´": 11283,
                            "ä½›å±±": 11283,
                            "æ±Ÿé—¨": 11283,
                            "æ¹›æ±Ÿ": 11283,
                            "èŒ‚å": 11283,
                            "è‚‡åº†": 11283,
                            "æƒ å·": 11283,
                            "æ¢…å·": 11283,
                            "æ±•å°¾": 11283,
                            "æ²³æº": 11283,
                            "é˜³æ±Ÿ": 11283,
                            "æ¸…è¿œ": 11283,
                            "ä¸œè": 11283,
                            "ä¸­å±±": 11283,
                            "æ½®å·": 11283,
                            "æ­é˜³": 11283,
                            "äº‘æµ®": 11283
                        },
                        "å¹¿è¥¿": {
                            "å—å®": 10342,
                            "æŸ³å·": 10342,
                            "æ¡‚æ—": 10342,
                            "æ¢§å·": 10342,
                            "åŒ—æµ·": 10342,
                            "é˜²åŸæ¸¯": 10342,
                            "é’¦å·": 10342,
                            "è´µæ¸¯": 10342,
                            "ç‰æ—": 10342,
                            "ç™¾è‰²": 10342,
                            "è´ºå·": 10342,
                            "æ²³æ± ": 10342,
                            "æ¥å®¾": 10342,
                            "å´‡å·¦": 10342
                        },
                        "æµ·å—": {
                            "æµ·å£": 10342,
                            "ä¸‰äºš": 10342,
                            "ä¸‰æ²™": 10342,
                            "å„‹å·": 10342,
                            "çœç›´è¾–å¿çº§è¡Œæ”¿åŒºåˆ’": 10342
                        },
                        "é‡åº†": {
                            "é‡åº†": 10342
                        },
                        "å››å·": {
                            "æˆéƒ½": 10342,
                            "è‡ªè´¡": 10342,
                            "æ”€æèŠ±": 10342,
                            "æ³¸å·": 10342,
                            "å¾·é˜³": 10342,
                            "ç»µé˜³": 10342,
                            "å¹¿å…ƒ": 10342,
                            "é‚å®": 10342,
                            "å†…æ±Ÿ": 10342,
                            "ä¹å±±": 10342,
                            "å—å……": 10342,
                            "çœ‰å±±": 10342,
                            "å®œå®¾": 10342,
                            "å¹¿å®‰": 10342,
                            "è¾¾å·": 10342,
                            "é›…å®‰": 10342,
                            "å·´ä¸­": 10342,
                            "èµ„é˜³": 10342,
                            "é˜¿åè—æ—ç¾Œæ—è‡ªæ²»å·": 10342,
                            "ç”˜å­œè—æ—è‡ªæ²»å·": 10342,
                            "å‡‰å±±å½æ—è‡ªæ²»å·": 10342
                        },
                        "è´µå·": {
                            "è´µé˜³": 10342,
                            "å…­ç›˜æ°´": 10342,
                            "éµä¹‰": 10342,
                            "å®‰é¡º": 10342,
                            "æ¯•èŠ‚": 10342,
                            "é“œä»": 10342,
                            "é»”è¥¿å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·": 10342,
                            "é»”ä¸œå—è‹—æ—ä¾—æ—è‡ªæ²»å·": 10342,
                            "é»”å—å¸ƒä¾æ—è‹—æ—è‡ªæ²»å·": 10342
                        },
                        "äº‘å—": {
                            "æ˜†æ˜": 10342,
                            "æ›²é–": 10342,
                            "ç‰æºª": 10342,
                            "ä¿å±±": 10342,
                            "æ˜­é€š": 10342,
                            "ä¸½æ±Ÿ": 10342,
                            "æ™®æ´±": 10342,
                            "ä¸´æ²§": 10342,
                            "æ¥šé›„å½æ—è‡ªæ²»å·": 10342,
                            "çº¢æ²³å“ˆå°¼æ—å½æ—è‡ªæ²»å·": 10342,
                            "æ–‡å±±å£®æ—è‹—æ—è‡ªæ²»å·": 10342,
                            "è¥¿åŒç‰ˆçº³å‚£æ—è‡ªæ²»å·": 10342,
                            "å¤§ç†ç™½æ—è‡ªæ²»å·": 10342,
                            "å¾·å®å‚£æ—æ™¯é¢‡æ—è‡ªæ²»å·": 10342,
                            "æ€’æ±Ÿå‚ˆåƒ³æ—è‡ªæ²»å·": 10342,
                            "è¿ªåº†è—æ—è‡ªæ²»å·": 10342
                        },
                        "è¥¿è—": {
                            "æ‹‰è¨": 10342,
                            "æ—¥å–€åˆ™": 10342,
                            "æ˜Œéƒ½": 10342,
                            "æ—èŠ": 10342,
                            "å±±å—": 10342,
                            "é‚£æ›²": 10342,
                            "é˜¿é‡Œåœ°åŒº": 10342
                        },
                        "é™•è¥¿": {
                            "è¥¿å®‰": 10342,
                            "é“œå·": 10342,
                            "å®é¸¡": 10342,
                            "å’¸é˜³": 10342,
                            "æ¸­å—": 10342,
                            "å»¶å®‰": 10342,
                            "æ±‰ä¸­": 10342,
                            "æ¦†æ—": 10342,
                            "å®‰åº·": 10342,
                            "å•†æ´›": 10342
                        },
                        "ç”˜è‚ƒ": {
                            "å…°å·": 10342,
                            "å˜‰å³ªå…³": 10342,
                            "é‡‘æ˜Œ": 10342,
                            "ç™½é“¶": 10342,
                            "å¤©æ°´": 10342,
                            "æ­¦å¨": 10342,
                            "å¼ æ–": 10342,
                            "å¹³å‡‰": 10342,
                            "é…’æ³‰": 10342,
                            "åº†é˜³": 10342,
                            "å®šè¥¿": 10342,
                            "é™‡å—": 10342,
                            "ä¸´å¤å›æ—è‡ªæ²»å·": 10342,
                            "ç”˜å—è—æ—è‡ªæ²»å·": 10342
                        },
                        "é’æµ·": {
                            "è¥¿å®": 10342,
                            "æµ·ä¸œ": 10342,
                            "æµ·åŒ—è—æ—è‡ªæ²»å·": 10342,
                            "é»„å—è—æ—è‡ªæ²»å·": 10342,
                            "æµ·å—è—æ—è‡ªæ²»å·": 10342,
                            "æœæ´›è—æ—è‡ªæ²»å·": 10342,
                            "ç‰æ ‘è—æ—è‡ªæ²»å·": 10342,
                            "æµ·è¥¿è’™å¤æ—è—æ—è‡ªæ²»å·": 10342
                        },
                        "å®å¤": {
                            "é“¶å·": 10342,
                            "çŸ³å˜´å±±": 10342,
                            "å´å¿ ": 10342,
                            "å›ºåŸ": 10342,
                            "ä¸­å«": 10342
                        },
                        "æ–°ç–†": {
                            "ä¹Œé²æœ¨é½": 10342,
                            "å…‹æ‹‰ç›ä¾": 10342,
                            "åé²ç•ª": 10342,
                            "å“ˆå¯†": 10342,
                            "æ˜Œå‰å›æ—è‡ªæ²»å·": 10342,
                            "åšå°”å¡”æ‹‰è’™å¤è‡ªæ²»å·": 10342,
                            "å·´éŸ³éƒ­æ¥è’™å¤è‡ªæ²»å·": 10342,
                            "é˜¿å…‹è‹åœ°åŒº": 10342,
                            "å…‹å­œå‹’è‹æŸ¯å°”å…‹å­œè‡ªæ²»å·": 10342,
                            "å–€ä»€åœ°åŒº": 10342,
                            "å’Œç”°åœ°åŒº": 10342,
                            "ä¼ŠçŠå“ˆè¨å…‹è‡ªæ²»å·": 10342,
                            "å¡”åŸåœ°åŒº": 10342,
                            "é˜¿å‹’æ³°åœ°åŒº": 10342,
                            "è‡ªæ²»åŒºç›´è¾–å¿çº§è¡Œæ”¿åŒºåˆ’": 10342
                        },
                        "å…¨å›½": {
                            "å…¨å›½": 10245
                        }
                    });
                }, 500); // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            });
        }

        // å­˜å‚¨è–ªèµ„æ•°æ®
        let avgSalaryData = {};
        
        // åˆå§‹åŒ–çœä»½ä¸‹æ‹‰æ¡†
        const provinceSelect = document.getElementById('province');
        const citySelect = document.getElementById('city');
        
        // é¡µé¢åŠ è½½æ—¶è·å–æ•°æ®
        async function initializeApp() {
            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                document.getElementById('location-info-text').innerHTML = '<i class="fas fa-spinner fa-spin"></i> æ­£åœ¨åŠ è½½æœ€æ–°æ•°æ®...';
                
                // è·å–æœ€æ–°æ•°æ®
                avgSalaryData = await fetchSalaryData();
                
                // æ·»åŠ çœä»½é€‰é¡¹
                Object.keys(avgSalaryData).forEach(province => {
                    const option = document.createElement('option');
                    option.value = province;
                    option.textContent = province;
                    provinceSelect.appendChild(option);
                });
                
                // æ›´æ–°ä½ç½®ä¿¡æ¯
                document.getElementById('location-info-text').textContent = "è¯·é€‰æ‹©çœä»½å’ŒåŸå¸‚è·å–å½“åœ°æœ€æ–°å¹³å‡å·¥èµ„æ•°æ®ï¼Œæœªé€‰ä¸­åŸå¸‚é»˜è®¤ä¸ºå…¨å›½2025å¹´å¹³å‡å·¥èµ„ï¼šÂ¥10,245/æœˆ";
                
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
                document.getElementById('location-info-text').textContent = "æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•";
            }
        }
        
        // åˆå§‹åŒ–åº”ç”¨
        initializeApp();
        
        // çœä»½å˜åŒ–æ—¶æ›´æ–°åŸå¸‚é€‰é¡¹
        provinceSelect.addEventListener('change', function() {
            citySelect.innerHTML = '<option value="">-- é€‰æ‹©åŸå¸‚ --</option>';
            const province = this.value;
            
            if (province && avgSalaryData[province]) {
                Object.keys(avgSalaryData[province]).forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.textContent = city;
                    citySelect.appendChild(option);
                });
                
                // è‡ªåŠ¨é€‰æ‹©ç¬¬ä¸€ä¸ªåŸå¸‚
                if (citySelect.options.length > 1) {
                    citySelect.selectedIndex = 1;
                }
            }
            
            updateLocationInfo();
        });
        
        // æ›´æ–°åŸå¸‚ä¿¡æ¯
        function updateLocationInfo() {
            const province = provinceSelect.value;
            const city = citySelect.value;
            let salary = 0;
            let infoText = '';
            
            if (province && city) {
                if (avgSalaryData[province] && avgSalaryData[province][city]) {
                    salary = avgSalaryData[province][city];
                    infoText = `${province}${city}2025å¹´å¹³å‡å·¥èµ„ï¼šÂ¥${salary.toLocaleString('zh-CN')}/æœˆ`;
                } else if (province === "å…¨å›½") {
                    salary = avgSalaryData["å…¨å›½"]["å…¨å›½"];
                    infoText = `2025å¹´å…¨å›½å¹³å‡å·¥èµ„ï¼šÂ¥${salary.toLocaleString('zh-CN')}/æœˆ`;
                } else {
                    salary = avgSalaryData[province]["å…¶ä»–"] || avgSalaryData["å…¨å›½"]["å…¨å›½"];
                    infoText = `${province}2025å¹´å¹³å‡å·¥èµ„ï¼šÂ¥${salary.toLocaleString('zh-CN')}/æœˆ`;
                }
            } else {
                infoText = "è¯·é€‰æ‹©çœä»½å’ŒåŸå¸‚è·å–å½“åœ°æœ€æ–°å¹³å‡å·¥èµ„æ•°æ®ï¼Œæœªé€‰ä¸­åŸå¸‚é»˜è®¤ä¸ºå…¨å›½2025å¹´å¹³å‡å·¥èµ„ï¼šÂ¥10,245/æœˆ";
            }
            
            document.getElementById('location-info-text').textContent = infoText;
            return salary;
        }
        
        // åˆå§‹æ›´æ–°ä½ç½®ä¿¡æ¯
        updateLocationInfo();
        
        // åŸå¸‚å˜åŒ–æ—¶æ›´æ–°ä¿¡æ¯
        citySelect.addEventListener('change', updateLocationInfo);
        
        // æ›´æ–°æ»‘å—å€¼æ˜¾ç¤º
        document.querySelectorAll('input[type="range"]').forEach(slider => {
            const valueDisplay = document.getElementById(`${slider.id}-value`);
            updateValueDisplay(slider, valueDisplay);
            
            slider.addEventListener('input', () => {
                updateValueDisplay(slider, valueDisplay);
            });
        });
        
        // ä¸ºé€€ä¼‘å¹´é¾„è¾“å…¥æ¡†æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
        const retirementAgeInput = document.getElementById('retirement-age');
        const retirementAgeValue = document.getElementById('retirement-age-value');
        
        retirementAgeInput.addEventListener('input', () => {
            retirementAgeValue.textContent = retirementAgeInput.value + 'å²';
        });
        
        function updateValueDisplay(slider, display) {
            if (slider.id === 'income' || slider.id === 'current-balance') {
                display.textContent = new Intl.NumberFormat('zh-CN').format(slider.value) + 'å…ƒ';
            } else if (slider.id === 'salary-growth' || slider.id === 'return-rate') {
                display.textContent = slider.value + '%';
            } else if (slider.id === 'contribution-rate') {
                display.textContent = slider.value + '%';
            } else if (slider.id === 'years-paid') {
                display.textContent = slider.value + 'å¹´';
            } else {
                display.textContent = slider.value + 'å²';
            }
        }
        
        // è®¡ç®—æŒ‰é’®äº‹ä»¶
        document.getElementById('calculate-btn').addEventListener('click', calculatePension);
        
        // ä¿å­˜è®¾ç½®æŒ‰é’®äº‹ä»¶
        document.getElementById('save-settings-btn').addEventListener('click', function() {
            DataPersistence.saveCurrentSettings();
        });
        
        // æŸ¥çœ‹å†å²æŒ‰é’®äº‹ä»¶
        document.getElementById('view-history-btn').addEventListener('click', function() {
            showCalculationHistory();
        });
        
        // å…³é—­å†å²è®°å½•æ¨¡æ€æ¡†
        document.getElementById('close-history-btn').addEventListener('click', function() {
            document.getElementById('history-modal').style.display = 'none';
        });
        
        // æ¸…ç©ºå†å²è®°å½•
        document.getElementById('clear-history-btn').addEventListener('click', function() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                DataPersistence.clearAllData();
                document.getElementById('history-modal').style.display = 'none';
                alert('å†å²è®°å½•å·²æ¸…ç©º');
            }
        });
        
        // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('history-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.style.display = 'none';
            }
        });
        
        // åº”ç”¨è®¡ç®—ç»“æœåˆ°UI
        function applyCalculationResult(resultData) {
            // æ›´æ–°UIæ˜¾ç¤º
            document.querySelector('.result-value').textContent = `Â¥${resultData.totalPension.toLocaleString('zh-CN')}/æœˆ`;
            document.querySelector('.progress-fill').style.width = `${Math.min(resultData.replacementRate, 100)}%`;
            
            // æ›´æ–°è¯¦ç»†æ•°æ®
            const detailValues = document.querySelectorAll('.detail-value');
            detailValues[0].textContent = `Â¥${resultData.basePension.toLocaleString('zh-CN')}/æœˆ`;
            detailValues[1].textContent = `Â¥${resultData.personalPension.toLocaleString('zh-CN')}/æœˆ`;
            detailValues[2].textContent = `${resultData.totalContributionYears}å¹´`;
            detailValues[3].textContent = `${resultData.replacementRate}%`;
            detailValues[4].textContent = `Â¥4,210/æœˆ`;
            detailValues[5].textContent = `70%ä»¥ä¸Š`;
            detailValues[6].textContent = `Â¥${resultData.localAvgSalary.toLocaleString('zh-CN')}/æœˆ`;
            
            // æ›´æ–°å»ºè®®
            const recommendation = document.querySelector('.recommendation');
            if (resultData.replacementRate < 50) {
                recommendation.innerHTML = `<strong><i class="fas fa-lightbulb"></i> ä¼˜åŒ–å»ºè®®ï¼š</strong> æ‚¨çš„å…»è€é‡‘æ›¿ä»£ç‡è¾ƒä½ï¼ˆ${resultData.replacementRate}%ï¼‰ã€‚å»ºè®®ï¼š1) å»¶é•¿å·¥ä½œå¹´é™è‡³65å²ï¼›2) æé«˜ç¼´è´¹åŸºæ•°è‡³150%ï¼›3) æ¯å¹´å¢åŠ Â¥10,000ä¸ªäººå…»è€ä¿é™©è¡¥å……ç¼´è´¹ã€‚`;
                recommendation.style.background = '#fdecea';
                recommendation.style.borderLeftColor = '#e74c3c';
            } else if (resultData.replacementRate < 70) {
                recommendation.innerHTML = `<strong><i class="fas fa-lightbulb"></i> ä¼˜åŒ–å»ºè®®ï¼š</strong> æ‚¨çš„å…»è€é‡‘æ›¿ä»£ç‡ï¼ˆ${resultData.replacementRate}%ï¼‰æ¥è¿‘åŸºæœ¬ç”Ÿæ´»éœ€æ±‚ã€‚å»ºè®®ï¼š1) å»¶é•¿å·¥ä½œå¹´é™è‡³63å²ï¼›2) æé«˜ç¼´è´¹åŸºæ•°è‡³120%ï¼›3) æ¯å¹´å¢åŠ Â¥6,000ä¸ªäººå…»è€é‡‘å‚¨è“„ã€‚`;
                recommendation.style.background = '#fff8e1';
                recommendation.style.borderLeftColor = '#f39c12';
            } else {
                recommendation.innerHTML = `<strong><i class="fas fa-lightbulb"></i> ä¼˜åŒ–å»ºè®®ï¼š</strong> æ­å–œï¼æ‚¨çš„å…»è€é‡‘æ›¿ä»£ç‡ï¼ˆ${resultData.replacementRate}%ï¼‰å·²è¾¾åˆ°è¾ƒç†æƒ³æ°´å¹³ã€‚å»ºè®®ï¼š1) ä¿æŒç°æœ‰ç¼´è´¹æ°´å¹³ï¼›2) å¢åŠ å…»è€ç”Ÿæ´»è´¨é‡å‚¨å¤‡ï¼›3) è€ƒè™‘æå‰é€€ä¼‘è®¡åˆ’ã€‚`;
                recommendation.style.background = '#e8f5e9';
                recommendation.style.borderLeftColor = '#27ae60';
            }
        }
        
        // æ˜¾ç¤ºè®¡ç®—å†å²çš„å‡½æ•°
        function showCalculationHistory() {
            const history = DataPersistence.getCalculationHistory();
            const historyList = document.getElementById('history-list');
            
            if (history.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #7f8c8d; padding: 20px;">æš‚æ— å†å²è®°å½•</p>';
            } else {
                // æŒ‰æ—¶é—´å€’åºæ’åˆ—
                history.reverse();
                
                let html = '<div class="history-items" style="display: grid; gap: 15px;">';
                
                history.forEach((item, index) => {
                    html += `
                    <div class="history-item" style="border: 1px solid #eee; border-radius: 8px; padding: 15px; background: #f9f9f9;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <strong>${item.date}</strong>
                            <button onclick="loadHistoryItem(${index})" class="btn" style="background: #2ecc71; padding: 6px 12px; font-size: 0.9rem;">è½½å…¥æ­¤è®°å½•</button>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                            <div><strong>æœˆå…»è€é‡‘:</strong> Â¥${item.result.totalPension.toLocaleString('zh-CN')}</div>
                            <div><strong>åŸºç¡€å…»è€é‡‘:</strong> Â¥${item.result.basePension.toLocaleString('zh-CN')}</div>
                            <div><strong>ä¸ªäººè´¦æˆ·å…»è€é‡‘:</strong> Â¥${item.result.personalPension.toLocaleString('zh-CN')}</div>
                            <div><strong>ç¼´è´¹å¹´é™:</strong> ${item.result.totalContributionYears}å¹´</div>
                            <div><strong>æ›¿ä»£ç‡:</strong> ${item.result.replacementRate}%</div>
                            <div><strong>é€€ä¼‘åœ°å¹³å‡å·¥èµ„:</strong> Â¥${item.result.localAvgSalary.toLocaleString('zh-CN')}/æœˆ</div>
                        </div>
                    </div>
                    `;
                });
                
                html += '</div>';
                historyList.innerHTML = html;
            }
            
            document.getElementById('history-modal').style.display = 'flex';
        }
        
        // è½½å…¥å†å²è®°å½•é¡¹
        function loadHistoryItem(index) {
            const history = DataPersistence.getCalculationHistory();
            if (index >= 0 && index < history.length) {
                const item = history[history.length - 1 - index]; // å› ä¸ºåœ¨æ˜¾ç¤ºæ—¶åè½¬äº†æ•°ç»„
                
                // æ¢å¤è®¾ç½®
                document.getElementById('age').value = item.settings.age;
                document.getElementById('retirement-age').value = item.settings.retirementAge;
                document.getElementById('income').value = item.settings.income;
                document.getElementById('contribution-rate').value = item.settings.contributionRate;
                document.getElementById('years-paid').value = item.settings.yearsPaid;
                document.getElementById('current-balance').value = item.settings.currentBalance;
                document.getElementById('salary-growth').value = item.settings.salaryGrowth;
                document.getElementById('return-rate').value = item.settings.returnRate;
                
                // æ›´æ–°æ˜¾ç¤ºå€¼
                updateValueDisplay(document.getElementById('age'), document.getElementById('age-value'));
                updateValueDisplay(document.getElementById('income'), document.getElementById('income-value'));
                updateValueDisplay(document.getElementById('contribution-rate'), document.getElementById('contribution-rate-value'));
                updateValueDisplay(document.getElementById('years-paid'), document.getElementById('years-paid-value'));
                updateValueDisplay(document.getElementById('current-balance'), document.getElementById('current-balance-value'));
                updateValueDisplay(document.getElementById('salary-growth'), document.getElementById('salary-growth-value'));
                updateValueDisplay(document.getElementById('return-rate'), document.getElementById('return-rate-value'));
                
                // è®¾ç½®çœä»½å’ŒåŸå¸‚
                if (item.settings.province) {
                    document.getElementById('province').value = item.settings.province;
                    
                    // è§¦å‘çœä»½é€‰æ‹©äº‹ä»¶ä»¥åŠ è½½å¯¹åº”çš„åŸå¸‚
                    const provinceEvent = new Event('change');
                    document.getElementById('province').dispatchEvent(provinceEvent);
                    
                    // ç­‰å¾…åŸå¸‚åŠ è½½å®Œæˆåè®¾ç½®åŸå¸‚å€¼
                    setTimeout(() => {
                        if (item.settings.city) {
                            document.getElementById('city').value = item.settings.city;
                            
                            // è§¦å‘åŸå¸‚é€‰æ‹©äº‹ä»¶
                            const cityEvent = new Event('change');
                            document.getElementById('city').dispatchEvent(cityEvent);
                        }
                        
                        // é‡æ–°è®¡ç®—å…»è€é‡‘
                        calculatePension();
                        
                        // å…³é—­å†å²è®°å½•æ¨¡æ€æ¡†
                        document.getElementById('history-modal').style.display = 'none';
                    }, 100);
                } else {
                    // é‡æ–°è®¡ç®—å…»è€é‡‘
                    calculatePension();
                    
                    // å…³é—­å†å²è®°å½•æ¨¡æ€æ¡†
                    document.getElementById('history-modal').style.display = 'none';
                }
            }
        }
        
        function validateInputs() {
            const age = parseInt(document.getElementById('age').value);
            const retirementAge = parseInt(document.getElementById('retirement-age').value);
            const income = parseInt(document.getElementById('income').value);
            const contributionRate = parseInt(document.getElementById('contribution-rate').value);
            const yearsPaid = parseInt(document.getElementById('years-paid').value);
            const currentBalance = parseInt(document.getElementById('current-balance').value);
            const salaryGrowth = parseFloat(document.getElementById('salary-growth').value);
            const returnRate = parseFloat(document.getElementById('return-rate').value);
            
            // æ¸…é™¤ä¹‹å‰çš„é”™è¯¯ä¿¡æ¯
            clearErrors();
            
            let isValid = true;
            let errorMessage = '';
            
            // éªŒè¯å¹´é¾„
            if (isNaN(age) || age < 18 || age > 65) {
                showError('å½“å‰å¹´é¾„å¿…é¡»åœ¨18-65å²ä¹‹é—´');
                isValid = false;
            }
            
            // éªŒè¯é€€ä¼‘å¹´é¾„
            if (isNaN(retirementAge) || retirementAge < 50 || retirementAge > 70) {
                showError('é€€ä¼‘å¹´é¾„å¿…é¡»åœ¨50-70å²ä¹‹é—´');
                isValid = false;
            } else if (retirementAge <= age) {
                showError('é€€ä¼‘å¹´é¾„å¿…é¡»å¤§äºå½“å‰å¹´é¾„');
                isValid = false;
            }
            
            // éªŒè¯æ”¶å…¥
            if (isNaN(income) || income < 3000 || income > 1000000) {
                showError('æœˆæ”¶å…¥å¿…é¡»åœ¨3000-1000000å…ƒä¹‹é—´');
                isValid = false;
            }
            
            // éªŒè¯ç¼´è´¹åŸºæ•°æ¯”ä¾‹
            if (isNaN(contributionRate) || contributionRate < 60 || contributionRate > 300) {
                showError('ç¼´è´¹åŸºæ•°æ¯”ä¾‹å¿…é¡»åœ¨60%-300%ä¹‹é—´');
                isValid = false;
            }
            
            // éªŒè¯å·²ç¼´è´¹å¹´é™
            if (isNaN(yearsPaid) || yearsPaid < 0 || yearsPaid > 50) {
                showError('å·²ç¼´è´¹å¹´é™ä¸èƒ½è¶…è¿‡50å¹´');
                isValid = false;
            }
            
            // éªŒè¯ä¸ªäººè´¦æˆ·ä½™é¢
            if (isNaN(currentBalance) || currentBalance < 0) {
                showError('ä¸ªäººè´¦æˆ·ä½™é¢ä¸èƒ½ä¸ºè´Ÿæ•°');
                isValid = false;
            }
            
            // éªŒè¯å·¥èµ„å¢é•¿ç‡
            if (isNaN(salaryGrowth) || salaryGrowth < 0 || salaryGrowth > 20) {
                showError('å·¥èµ„å¹´å¢é•¿ç‡åº”åœ¨0%-20%ä¹‹é—´');
                isValid = false;
            }
            
            // éªŒè¯ä¸ªäººè´¦æˆ·æ”¶ç›Šç‡
            if (isNaN(returnRate) || returnRate < 0 || returnRate > 20) {
                showError('ä¸ªäººè´¦æˆ·æ”¶ç›Šç‡åº”åœ¨0%-20%ä¹‹é—´');
                isValid = false;
            }
            
            return isValid;
        }
        
        function showError(message) {
            // åˆ›å»ºé”™è¯¯æç¤ºå…ƒç´ 
            const errorDiv = document.createElement('div');
            errorDiv.className = 'input-error';
            errorDiv.style.cssText = `
                color: #e74c3c;
                font-size: 0.9rem;
                margin-top: 5px;
                padding: 5px 0;
                display: flex;
                align-items: center;
            `;
            errorDiv.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
            
            // æ·»åŠ åˆ°é¡µé¢é¡¶éƒ¨ä½œä¸ºå…¨å±€é”™è¯¯æç¤º
            const container = document.querySelector('.container');
            if (!document.querySelector('.global-error')) {
                errorDiv.classList.add('global-error');
                container.insertBefore(errorDiv, container.firstChild);
            } else {
                document.querySelector('.global-error').innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
            }
        }
        
        function clearErrors() {
            const globalError = document.querySelector('.global-error');
            if (globalError) {
                globalError.remove();
            }
            
            // æ¸…é™¤è¾“å…¥æ¡†çš„é”™è¯¯æ ·å¼
            document.querySelectorAll('.form-group input, .form-group select').forEach(element => {
                element.style.borderColor = '';
            });
        }
        
        // ç¼“å­˜æœºåˆ¶
        const CacheManager = {
            cache: new Map(),
            
            // ç”Ÿæˆç¼“å­˜é”®
            generateCacheKey: function(settings) {
                return JSON.stringify({
                    age: settings.age,
                    retirementAge: settings.retirementAge,
                    income: settings.income,
                    contributionRate: settings.contributionRate,
                    yearsPaid: settings.yearsPaid,
                    currentBalance: settings.currentBalance,
                    salaryGrowth: settings.salaryGrowth,
                    returnRate: settings.returnRate,
                    province: settings.province,
                    city: settings.city
                });
            },
            
            // è·å–ç¼“å­˜
            get: function(key) {
                const cached = this.cache.get(key);
                if (cached && (Date.now() - cached.timestamp < 300000)) { // 5åˆ†é’Ÿè¿‡æœŸ
                    return cached.data;
                } else {
                    // å¦‚æœè¿‡æœŸåˆ™åˆ é™¤
                    if (cached) {
                        this.cache.delete(key);
                    }
                    return null;
                }
            },
            
            // è®¾ç½®ç¼“å­˜
            set: function(key, data) {
                this.cache.set(key, {
                    data: data,
                    timestamp: Date.now()
                });
            },
            
            // æ¸…é™¤ç¼“å­˜
            clear: function() {
                this.cache.clear();
            },
            
            // è·å–ç¼“å­˜å¤§å°
            size: function() {
                return this.cache.size;
            }
        };
        
        // æ•°æ®æŒä¹…åŒ–åŠŸèƒ½
        const DataPersistence = {
            // ä¿å­˜å½“å‰è®¾ç½®
            saveCurrentSettings: function() {
                const settings = {
                    age: document.getElementById('age').value,
                    retirementAge: document.getElementById('retirement-age').value,
                    income: document.getElementById('income').value,
                    contributionRate: document.getElementById('contribution-rate').value,
                    yearsPaid: document.getElementById('years-paid').value,
                    currentBalance: document.getElementById('current-balance').value,
                    salaryGrowth: document.getElementById('salary-growth').value,
                    returnRate: document.getElementById('return-rate').value,
                    province: document.getElementById('province').value,
                    city: document.getElementById('city').value,
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('pensionCalculatorSettings', JSON.stringify(settings));
                alert('è®¾ç½®å·²ä¿å­˜ï¼');
            },
            
            // åŠ è½½ä¿å­˜çš„è®¾ç½®
            loadSavedSettings: function() {
                const savedSettings = localStorage.getItem('pensionCalculatorSettings');
                if (savedSettings) {
                    try {
                        const settings = JSON.parse(savedSettings);
                        
                        // æ¢å¤å„é¡¹è®¾ç½®
                        document.getElementById('age').value = settings.age || 30;
                        document.getElementById('retirement-age').value = settings.retirementAge || 60;
                        document.getElementById('income').value = settings.income || 6000;
                        document.getElementById('contribution-rate').value = settings.contributionRate || 100;
                        document.getElementById('years-paid').value = settings.yearsPaid || 10;
                        document.getElementById('current-balance').value = settings.currentBalance || 30000;
                        document.getElementById('salary-growth').value = settings.salaryGrowth || 0;
                        document.getElementById('return-rate').value = settings.returnRate || 5;
                        
                        // æ›´æ–°æ˜¾ç¤ºå€¼
                        updateValueDisplay(document.getElementById('age'), document.getElementById('age-value'));
                        updateValueDisplay(document.getElementById('income'), document.getElementById('income-value'));
                        updateValueDisplay(document.getElementById('contribution-rate'), document.getElementById('contribution-rate-value'));
                        updateValueDisplay(document.getElementById('years-paid'), document.getElementById('years-paid-value'));
                        updateValueDisplay(document.getElementById('current-balance'), document.getElementById('current-balance-value'));
                        updateValueDisplay(document.getElementById('salary-growth'), document.getElementById('salary-growth-value'));
                        updateValueDisplay(document.getElementById('return-rate'), document.getElementById('return-rate-value'));
                        
                        // è®¾ç½®çœä»½å’ŒåŸå¸‚
                        if (settings.province) {
                            document.getElementById('province').value = settings.province;
                            
                            // è§¦å‘çœä»½é€‰æ‹©äº‹ä»¶ä»¥åŠ è½½å¯¹åº”çš„åŸå¸‚
                            const provinceEvent = new Event('change');
                            document.getElementById('province').dispatchEvent(provinceEvent);
                            
                            // ç­‰å¾…åŸå¸‚åŠ è½½å®Œæˆåè®¾ç½®åŸå¸‚å€¼
                            setTimeout(() => {
                                if (settings.city) {
                                    document.getElementById('city').value = settings.city;
                                    
                                    // è§¦å‘åŸå¸‚é€‰æ‹©äº‹ä»¶
                                    const cityEvent = new Event('change');
                                    document.getElementById('city').dispatchEvent(cityEvent);
                                }
                            }, 100);
                        }
                        
                        // é‡æ–°è®¡ç®—å…»è€é‡‘
                        calculatePension();
                        
                        return true;
                    } catch (e) {
                        console.error('åŠ è½½ä¿å­˜çš„è®¾ç½®å¤±è´¥:', e);
                        return false;
                    }
                }
                return false;
            },
            
            // ä¿å­˜è®¡ç®—å†å²
            saveCalculationHistory: function(result) {
                const history = JSON.parse(localStorage.getItem('pensionCalculatorHistory') || '[]');
                
                const entry = {
                    result: result,
                    settings: {
                        age: document.getElementById('age').value,
                        retirementAge: document.getElementById('retirement-age').value,
                        income: document.getElementById('income').value,
                        contributionRate: document.getElementById('contribution-rate').value,
                        yearsPaid: document.getElementById('years-paid').value,
                        currentBalance: document.getElementById('current-balance').value,
                        salaryGrowth: document.getElementById('salary-growth').value,
                        returnRate: document.getElementById('return-rate').value,
                        province: document.getElementById('province').value,
                        city: document.getElementById('city').value
                    },
                    timestamp: new Date().toISOString(),
                    date: new Date().toLocaleString('zh-CN')
                };
                
                // é™åˆ¶å†å²è®°å½•æ•°é‡ä¸º20æ¡
                if (history.length >= 20) {
                    history.shift(); // åˆ é™¤æœ€æ—§çš„è®°å½•
                }
                
                history.push(entry);
                localStorage.setItem('pensionCalculatorHistory', JSON.stringify(history));
            },
            
            // è·å–è®¡ç®—å†å²
            getCalculationHistory: function() {
                return JSON.parse(localStorage.getItem('pensionCalculatorHistory') || '[]');
            },
            
            // æ¸…é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®
            clearAllData: function() {
                localStorage.removeItem('pensionCalculatorSettings');
                localStorage.removeItem('pensionCalculatorHistory');
            }
        };
        
        // é¡µé¢åŠ è½½æ—¶å°è¯•æ¢å¤è®¾ç½®
        window.addEventListener('load', function() {
            DataPersistence.loadSavedSettings();
        });
        
        function showLoading() {
            // åˆ›å»ºåŠ è½½é®ç½©
            let overlay = document.getElementById('loading-overlay');
            if (!overlay) {
                overlay = document.createElement('div');
                overlay.id = 'loading-overlay';
                overlay.className = 'loading-overlay';
                overlay.innerHTML = `
                    <div class="loading-spinner">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>æ­£åœ¨è®¡ç®—ä¸­...</p>
                    </div>
                `;
                document.body.appendChild(overlay);
            }
            overlay.style.display = 'flex';
        }
        
        function hideLoading() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
                overlay.style.display = 'none';
            }
        }
        
        function calculatePension() {
            // é¦–å…ˆéªŒè¯è¾“å…¥
            if (!validateInputs()) {
                return;
            }
            
            // å‡†å¤‡è®¾ç½®å¯¹è±¡ç”¨äºç¼“å­˜
            const settings = {
                age: document.getElementById('age').value,
                retirementAge: document.getElementById('retirement-age').value,
                income: document.getElementById('income').value,
                contributionRate: document.getElementById('contribution-rate').value,
                yearsPaid: document.getElementById('years-paid').value,
                currentBalance: document.getElementById('current-balance').value,
                salaryGrowth: document.getElementById('salary-growth').value,
                returnRate: document.getElementById('return-rate').value,
                province: document.getElementById('province').value,
                city: document.getElementById('city').value
            };
            
            // ç”Ÿæˆç¼“å­˜é”®
            const cacheKey = CacheManager.generateCacheKey(settings);
            
            // å°è¯•ä»ç¼“å­˜è·å–ç»“æœ
            const cachedResult = CacheManager.get(cacheKey);
            if (cachedResult) {
                // ä½¿ç”¨ç¼“å­˜çš„ç»“æœ
                applyCalculationResult(cachedResult);
                return;
            }
            
            // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
            showLoading();
            
            // ä½¿ç”¨setTimeoutç¡®ä¿UIæ›´æ–°åå†æ‰§è¡Œè®¡ç®—
            setTimeout(() => {
                try {
                    // è·å–è¾“å…¥å€¼
                    const age = parseInt(document.getElementById('age').value);
                    const retirementAge = parseInt(document.getElementById('retirement-age').value);
                    const income = parseInt(document.getElementById('income').value);
                    const contributionRate = parseInt(document.getElementById('contribution-rate').value) / 100;
                    const yearsPaid = parseInt(document.getElementById('years-paid').value);
                    const currentBalance = parseInt(document.getElementById('current-balance').value);
                    const salaryGrowth = parseFloat(document.getElementById('salary-growth').value) / 100;
                    const returnRate = parseFloat(document.getElementById('return-rate').value) / 100;
                    const province = document.getElementById('province').value;
                    const city = document.getElementById('city').value;
                    
                    // è·å–é€€ä¼‘åœ°å¹³å‡å·¥èµ„
                    let localAvgSalary = 0;
                    if (avgSalaryData && avgSalaryData["å…¨å›½"] && avgSalaryData["å…¨å›½"]["å…¨å›½"]) {
                        if (province && city) {
                            if (avgSalaryData[province] && avgSalaryData[province][city]) {
                                localAvgSalary = avgSalaryData[province][city];
                            } else if (province === "å…¨å›½") {
                                localAvgSalary = avgSalaryData["å…¨å›½"]["å…¨å›½"];
                            } else {
                                localAvgSalary = avgSalaryData[province] && avgSalaryData[province]["å…¶ä»–"] ? avgSalaryData[province]["å…¶ä»–"] : avgSalaryData["å…¨å›½"]["å…¨å›½"];
                            }
                        } else {
                            localAvgSalary = avgSalaryData["å…¨å›½"]["å…¨å›½"];
                        }
                    } else {
                        // å¦‚æœæ•°æ®æœªåŠ è½½ï¼Œä½¿ç”¨é»˜è®¤å€¼
                        localAvgSalary = 10245;
                    }
                    
                    // è®¡ç®—æ€»å·¥ä½œå¹´é™
                    const totalYears = retirementAge - age;
                    const totalContributionYears = yearsPaid + totalYears;
                    
                    // è®¡ç®—åŸºç¡€å…»è€é‡‘
                    // æœ¬äººæŒ‡æ•°åŒ–æœˆå¹³å‡ç¼´è´¹å·¥èµ„ï¼ˆç®€åŒ–è®¡ç®—ï¼‰
                    const indexedSalary = income * contributionRate;
                    
                    // åŸºç¡€å…»è€é‡‘å…¬å¼ï¼š(é€€ä¼‘æ—¶ä¸Šå¹´åº¦ç¤¾å¹³å·¥èµ„ + æœ¬äººæŒ‡æ•°åŒ–æœˆå¹³å‡ç¼´è´¹å·¥èµ„) / 2 Ã— ç¼´è´¹å¹´é™ Ã— 1%
                    const basePension = (localAvgSalary + indexedSalary) / 2 * totalContributionYears * 0.01;
                    
                    // è®¡ç®—ä¸ªäººè´¦æˆ·å…»è€é‡‘
                    // æ¨¡æ‹Ÿè®¡ç®—ä¸ªäººè´¦æˆ·ç§¯ç´¯
                    let personalAccount = currentBalance;
                    let currentSalary = income;
                    
                    // å·²ç¼´è´¹å¹´é™ç§¯ç´¯ï¼ˆç®€åŒ–è®¡ç®—ï¼‰
                    personalAccount += yearsPaid * 12 * currentSalary * 0.08 * Math.pow(1 + returnRate, yearsPaid);
                    
                    // æœªæ¥ç¼´è´¹å¹´é™ç§¯ç´¯ï¼ˆå¤åˆ©è®¡ç®—ï¼‰
                    for (let i = 1; i <= totalYears; i++) {
                        currentSalary *= (1 + salaryGrowth);
                        const annualContribution = 12 * currentSalary * 0.08;
                        personalAccount += annualContribution * Math.pow(1 + returnRate, totalYears - i + 1);
                    }
                    
                    // è®¡å‘æœˆæ•°ï¼ˆæ ¹æ®é€€ä¼‘å¹´é¾„ï¼‰
                    let monthsFactor;
                    if (retirementAge <= 50) {
                        monthsFactor = 195;
                    } else if (retirementAge <= 55) {
                        monthsFactor = 170;
                    } else if (retirementAge <= 60) {
                        monthsFactor = 139;
                    } else if (retirementAge <= 65) {
                        monthsFactor = 101;
                    } else {
                        // 65å²ä»¥ä¸Šï¼ŒæŒ‰çº¿æ€§é€’å‡è®¡ç®—
                        monthsFactor = Math.max(80, 101 - (retirementAge - 65) * 4);
                    }
                    
                    const personalPension = personalAccount / monthsFactor;
                    
                    // æ€»å…»è€é‡‘
                    const totalPension = basePension + personalPension;
                    
                    // å…»è€é‡‘æ›¿ä»£ç‡ï¼ˆå…»è€é‡‘/é€€ä¼‘å‰æ”¶å…¥ï¼‰
                    const replacementRate = (totalPension / (currentSalary * 0.8)) * 100;
                    
                    // åˆ›å»ºç»“æœå¯¹è±¡
                    const resultData = {
                        totalPension: Math.round(totalPension),
                        basePension: Math.round(basePension),
                        personalPension: Math.round(personalPension),
                        totalContributionYears: totalContributionYears,
                        replacementRate: Math.round(replacementRate),
                        localAvgSalary: Math.round(localAvgSalary)
                    };
                    
                    // åº”ç”¨è®¡ç®—ç»“æœåˆ°UI
                    applyCalculationResult(resultData);
                    
                    // ä¿å­˜åˆ°ç¼“å­˜
                    CacheManager.set(cacheKey, resultData);
                    
                    // ä¿å­˜è®¡ç®—å†å²
                    DataPersistence.saveCalculationHistory(resultData);
                } catch (error) {
                    console.error('è®¡ç®—å¤±è´¥:', error);
                    showError('è®¡ç®—è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥è¾“å…¥å‚æ•°æˆ–åˆ·æ–°é¡µé¢é‡è¯•');
                } finally {
                    // éšè—åŠ è½½çŠ¶æ€
                    hideLoading();
                }
            }, 100); // å»¶è¿Ÿ100æ¯«ç§’ä»¥ç¡®ä¿ç”¨æˆ·èƒ½çœ‹åˆ°åŠ è½½çŠ¶æ€
        }
        
        // åˆå§‹è®¡ç®—
        setTimeout(() => {
            calculatePension();
        }, 1000); // å»¶è¿Ÿ1ç§’ä»¥ç¡®ä¿æ•°æ®åŠ è½½å®Œæˆ
    </script>
</body>
</html>